/**
 * @ngdoc directive
 * @name VideoPreview
 * @module VideoApp
 *
 * @description
 * This directive displays the video
 *
 * ### Usage
 * <video-preview video="video"></video-preview>
 */
(function() {
'use strict';

var controller = function(
  $scope, $sce,
  Video
) {
  /**
   * Scope Methods
   */
  $scope.youtubeUrl = function() {
    var url = 'https://www.youtube.com/embed/'
      + $scope.video.video_id
      + '?autoplay=1&version=3&rel=0';
    if($scope.video.start_time) {
      url += '&start=' + $scope.video.start_time;
    }
    if($scope.video.end_time) {
      url += '&end=' + $scope.video.end_time;
    }
    return $sce.trustAsResourceUrl(url);
  };
};

controller.$inject = [
  '$scope', '$sce',
  'Video'
];

var VideoPreview = function() {
  return {
    restrict: 'E',
    scope: {
      video: '='
    },
    controller: controller,
    templateUrl: '<%= asset_path("apps/videos/templates/video_preview.html") %>'
  };
};

angular.module('VideoApp')
       .directive('videoPreview', VideoPreview);
}());
